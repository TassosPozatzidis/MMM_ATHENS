<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>'Εκδοση εισητηρίων</title>
        <script defer src="/__/firebase/8.2.2/firebase-app.js"></script>
        <!-- include only the Firebase features as you need -->
        <script defer src="/__/firebase/8.2.2/firebase-auth.js"></script>
        <script defer src="/__/firebase/8.2.2/firebase-database.js"></script>
        <script defer src="/__/firebase/8.2.2/firebase-firestore.js"></script>
        <script defer src="/__/firebase/8.2.2/firebase-functions.js"></script>
        <script defer src="/__/firebase/8.2.2/firebase-messaging.js"></script>
        <script defer src="/__/firebase/8.2.2/firebase-storage.js"></script>
        <script defer src="/__/firebase/8.2.2/firebase-analytics.js"></script>
        <script defer src="/__/firebase/8.2.2/firebase-remote-config.js"></script>
        <script defer src="/__/firebase/8.2.2/firebase-performance.js"></script>
        <script defer src="/__/firebase/init.js?useEmulator=true"></script>
        <!-- Favicon-->
        <link rel="icon" type="image/x-icon" href="basicwebsite/public/assets/favicon.ico" />
        <!-- Bootstrap icons-->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet" />
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="styles.css" rel="stylesheet" />
        <script src="/__/firebase/9.6.1/firebase-app-compat.js"></script>
        <script src="/__/firebase/9.6.1/firebase-auth-compat.js"></script>
        <script src="/__/firebase/init.js"></script>
        
    </head>
    <body>
        
        <!-- Responsive navbar-->
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
            <div class="container px-lg-5">
                <a class="navbar-brand" href="generic.html">ΑΤΗ.ΕΝΑ ticket</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
                        <li class="nav-item"><a class="nav-link"  href="generic.html">Αρχική</a></li>
                        <li class="nav-item"><a class="nav-link"  href="about.hmtl">Σχετικά</a></li>
                        <li class="nav-item"><a class="nav-link"  href="contact.html">Επικοινωνία</a></li>
                        <li class="nav-item"><a class="nav-link"  id="logout" onclick="signOut()">Log Out</a></li>
                        <li class="nav-item"><a class="nav-link active"  id="account-details"> User: </a></li>
                        
                    </ul>
                </div>
            </div>
        </nav>
        <header class="py-5">
            <div class="container px-lg-5">
                <div class="p-4 p-lg-5 bg-light rounded-3 text-center">
                        <h1 class="display-5 fw-bold">Ψηφιακό εισιτήριο</h1>
                        <p class="fs-4">Αγοράστε το εισιτήριο της επιλογή σας και αποθηκεύστε το στην συσκευή σας. Εύκολη χρήση του εισιτηρίου ανά πάσα στιγμή.</p>
                        <!--<a class="btn btn-primary btn-lg" href="#!">Call to action</a>-->
                </div>
            </div>
        </header>
        
        <section class="pt-4">
            <div class="container px-lg-5">
                <!-- Page Features-->
                <div class="row gx-lg-5">
                    <div class="col-lg-6 col-xxl-4 mb-5">
                        <div class="card bg-light border-0 h-100">
                            <div class="card-body text-center p-4 p-lg-5 pt-0 pt-lg-0">
                                <div class="feature bg-primary bg-gradient text-white rounded-3 mb-4 mt-n4"><i class="bi bi-card-heading"></i></div>
                                <h2 class="fs-4 fw-bold">Εννιαίο εισιτήριο</h2>
                                <p class="mb-0">Το ενιαίο εισιτήριο, ισχύει σε όλα τα μέσα αρμοδιότητας ΟΑΣΑ: Λεωφορεία, Τρόλεϊ, Τραμ, Ηλεκτρικό Σιδηρόδρομο, Μετρό (μέχρι Κορωπί) και στην ΤΡΑΙΝΟΣΕ (στο τμήμα του Προαστιακού Μαγούλα-Πειραιάς-Κορωπί).
                                    Δεν ισχύει στις λεωφορειακές γραμμές EXPRESS του Αεροδρομίου, στη γραμμή Χ80 και στο Μετρό στο τμήμα Κορωπί-Αεροδρόμιο.
                                    Ο χρόνος ισχύος του ενιαίου εισιτηρίου είναι 90 λεπτά από την πρώτη επικύρωσή του.</p>
                                <p class="mb-0"><strong>Κόστος:1,20&euro;</strong></p>

                              </br><a class="btn btn-primary btn-lg" id="eniaio" name="eniaio" onclick="downloadFile('Simple.pdf')">Έκδοση</a>
                            </div>
                        </div>
                    </div>


                    
                    <div class="col-lg-6 col-xxl-4 mb-5">
                        <div class="card bg-light border-0 h-100">
                            <div class="card-body text-center p-4 p-lg-5 pt-0 pt-lg-0">
                                <div class="feature bg-primary bg-gradient text-white rounded-3 mb-4 mt-n4"><i class="bi bi-card-heading"></i></div>
                                <h2 class="fs-4 fw-bold"> Ημερήσιο εισιτήριο</h2>
                                <p class="mb-0">Το ημερήσιο εισιτήριο ισχύει σε όλα τα μέσα αρμοδιότητας ΟΑΣΑ: Λεωφορεία, Τρόλεϊ, Τραμ, Ηλεκτρικό Σιδηρόδρομο, Μετρό (μέχρι Κορωπί) και στην ΤΡΑΙΝΟΣΕ (στο τμήμα του Προαστιακού Μαγούλα-Πειραιάς-Κορωπί). Ισχύει στη γραμμή Χ80.
                                    Ισχύει για 24 ώρες από την πρώτη επικύρωσή του.
                                    Δεν ισχύει στις λεωφορειακές γραμμές EXPRESS του Αεροδρομίου, και στο Μετρό στο τμήμα Κορωπί-Αεροδρόμιο.</p>
                                    <p class="mb-0"><strong>Κόστος:4,10&euro;</strong></p>
                              </br><a class="btn btn-primary btn-lg" id="daily" name="daily" onclick="downloadFile('OneDay.pdf')">Έκδοση</a>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-6 col-xxl-4 mb-5">
                        <div class="card bg-light border-0 h-100">
                            <div class="card-body text-center p-4 p-lg-5 pt-0 pt-lg-0">
                                <div class="feature bg-primary bg-gradient text-white rounded-3 mb-4 mt-n4"><i class="bi bi-card-heading"></i></div>
                                <h2 class="fs-4 fw-bold">Τουριστικό εισητήριο 3 ημερών</h2>
                                <p class="mb-0">Το 3ημερο τουριστικό εισιτήριο ισχύει για 3 πλήρη 24ωρα από την πρώτη επικύρωσή του, σε όλα τα μέσα αρμοδιότητας ΟΑΣΑ:
                                     Λεωφορεία, Τρόλεϊ, Τραμ, Ηλεκτρικό Σιδηρόδρομο, Μετρό (μέχρι Κορωπί) και στην ΤΡΑΙΝΟΣΕ (στο τμήμα του Προαστιακού Μαγούλα-Πειραιάς-Κορωπί). Επίσης περιλαμβάνει μια διαδρομή από και μια προς τον Διεθνή Αερολιμένα Αθηνών με το Μετρό ή τις αντίστοιχες λεωφορειακές γραμμές EXPRESS. Το εισιτήριο αυτό ισχύει και στη λεωφορειακή γραμμή Χ80.</p>
                                     <p class="mb-0"><strong>Κόστος:20,00&euro;</strong></p>
                                    </br><a class="btn btn-primary btn-lg" id="tour" name="tour" onclick="downloadFile('Tourist.pdf')">Έκδοση</a>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-6 col-xxl-4 mb-5">
                        <div class="card bg-light border-0 h-100">
                            <div class="card-body text-center p-4 p-lg-5 pt-0 pt-lg-0">
                                <div class="feature bg-primary bg-gradient text-white rounded-3 mb-4 mt-n4"><i class="bi bi-card-heading"></i></div>
                                <h2 class="fs-4 fw-bold"> Λεωφοριακές γραμμές EXPRESS</h2>
                                <p class="mb-0">Τα εισιτήρια για τις λεωφορειακές γραμμές EXPRESS του Αεροδρομίου ισχύουν για μία μόνο διαδρομή, από ή προς το Αεροδρόμιο.</p>
                                <p class="mb-0"><strong>Κόστος:5,50&euro;</strong></p>
                            </br><a class="btn btn-primary btn-lg" id="express" name="express" onclick="downloadFile('Express.pdf')" >Έκδοση</a>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-lg-6 col-xxl-4 mb-5">
                        <div class="card bg-light border-0 h-100">
                            <div class="card-body text-center p-4 p-lg-5 pt-0 pt-lg-0">
                                <div class="feature bg-primary bg-gradient text-white rounded-3 mb-4 mt-n4"><i class="bi bi-card-heading"></i></div>
                                <h2 class="fs-4 fw-bold"> Eισιτήριο μετρό αεροδρομίου</h2>
                                <p class="mb-0">Τα εισιτήρια Αεροδρομίου του Μετρό ισχύουν σε όλα τα μέσα αρμοδιότητας ΟΑΣΑ για 90 λεπτά από την πρώτη επικύρωσή τους σε πύλη σταθμού του μετρό ή σε επικυρωτικό μηχάνημα στα Λεωφορεία, Τρόλεϊ, Τραμ.</p>
                                <p class="mb-0"><strong>Κόστος:9,00&euro;</strong></p>
                            </br><a class="btn btn-primary btn-lg" id="aerport1" name="aerport1" onclick="downloadFile('AirportOne.pdf')">Έκδοση</a>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-6 col-xxl-4 mb-5">
                        <div class="card bg-light border-0 h-100">
                            <div class="card-body text-center p-4 p-lg-5 pt-0 pt-lg-0">
                                <div class="feature bg-primary bg-gradient text-white rounded-3 mb-4 mt-n4"><i class="bi bi-card-heading"></i></div>
                                <h2 class="fs-4 fw-bold"> Eισιτήριο αεροδρομίου από/προς Παλλήνη-Κάντζα-Κορωπί μετρό</h2>
                                <p class="mb-0">Τα εισιτήρια του ΜΕΤΡΟ από τους σταθμούς Παλλήνη, Κάντζα, Κορωπί προς και από το Αεροδρόμιο, ισχύουν σε όλα τα μέσα αρμοδιότητας ΟΑΣΑ για 90 λεπτά από την επικύρωσή τους σε πύλη σταθμού του μετρό ή σε επικυρωτικό μηχάνημα στα Λεωφορεία, Τρόλεϊ, Τραμ.
                                    Ισχύουν επίσης και στην ΤΡΑΙΝΟΣΕ (στο τμήμα του Προαστιακού Μαγούλα-Πειραιάς-Αεροδρόμιο).
                                    Δεν ισχύει στις λεωφορειακές γραμμές EXPRESS του Αεροδρομίου, στη γραμμή Χ80.</p>
                                <p class="mb-0"><strong>Κόστος:5,50&euro;</strong></p>
                              </br><a class="btn btn-primary btn-lg" id="aerport2" name="aerport2" onclick="downloadFile('Airport.pdf')">Έκδοση</a>
                            </div>
                        </div>
                    </div>



                    

                </div>
            </div>




        </section>
        <!-- Footer-->
        <footer class="py-5 bg-dark">
            <div class="container"><p class="m-0 text-center text-white">Copyright &copy; GMIT@Unipi 2021</p></div>
        </footer>
        
<script>

        document.addEventListener('DOMContentLoaded', function () {
        listenForChanges();
        listenForFiles();
        listenUser();
    });
        function downloadFile(FileN){

            var storage = firebase.storage();
            var pathReference = storage.ref('tickets/'+FileN);
                    firebase.storage().ref().child('tickets/'+FileN).getDownloadURL()
  .then((url) => {
    // This can be downloaded directly:
    var xhr = new XMLHttpRequest();
    xhr.responseType = 'blob';
    xhr.onload = (event) => {
      var blob = xhr.response;
    };
    xhr.open('GET', url);
    xhr.send();
    window.open(url, '_blank').focus();

    // Or inserted into an <img> element

  })
  .catch((error) => {
    switch (error.code) {
    case 'storage/object-not-found':
      // File doesn't exist
      break;
    case 'storage/unauthorized':
      // User doesn't have permission to access the object
      break;
    case 'storage/canceled':
      // User canceled the upload
      break;

    // ...

    case 'storage/unknown':
      // Unknown error occurred, inspect the server response
      break;
  }
    // Handle any errors
  });
}
  function listenUser(){
 //   firebase.auth().onAuthStateChanged(user => {
 //       console.log(user);
 //       
 //   })

    firebase.auth().onAuthStateChanged(user => {
 if (user) {
  const { currentUser } = firebaseApp.auth();
  console.log('Currently logged in user', currentUser);
  store.dispatch(userLoggedIn(currentUser.uid));
  browserHistory.push('/newsfeed');
  // save the current user's uid to redux store.
 } else {
  browserHistory.push('/signin');
  // delete the current user's uid from the redux store.
 }
})

  }
  function getUser(){
      
            const user = firebase.auth().currentUser;
            if (user !== null) {
            // The user object has basic properties such as display name, email, etc.
            const displayName = user.displayName;
            const email = user.email;


            // The user's ID, unique to the Firebase project. Do NOT use
            // this value to authenticate with your backend server, if
            // you have one. Use User.getToken() instead.
            const uid = user.uid;
            console.log(user);
            document.getElementById('account-details').innerHTML = email;
            }
          }

function initApp2() {
    firebase.auth().onAuthStateChanged(function(user) {
      if (user) {
        // User is signed in.
        console.log(user);
        
        var displayName = user.displayName;
        var email = user.email;
        var emailVerified = user.emailVerified;
        var photoURL = user.photoURL;
        var uid = user.uid;
        var phoneNumber = user.phoneNumber;
        var providerData = user.providerData;
        document.getElementById('account-details').innerHTML = email;
        user.getIdToken().then(function(accessToken) {
          document.getElementById('sign-in-status').textContent = 'Signed in';
          document.getElementById('sign-in').textContent = 'Sign out';
          document.getElementById('account-details').textContent = JSON.stringify({
            email: email,
            uid: uid
          }, null, '  ');
        });
      } else {
        // User is signed out.
        console.log(user);
        window.location="generic.html";

      }
    }, function(error) {
      console.log(error);
    });
  };

  window.addEventListener('load', function() {
    initApp2()
  });
  function initApp() {
              // Listening for auth state changes.
              firebase.auth().onAuthStateChanged(function(user) {
                if (user) {
                  // User is signed in.
                  var displayName = user.displayName;
                  var email = user.email;
                  var emailVerified = user.emailVerified;
                  var uid = user.uid;
                  var providerData = user.providerData;
                    console.log(user);
                  document.getElementById('').textContent =email;
                  if (!emailVerified) {
                    document.getElementById('quickstart-verify-email').disabled = false;
                  }
                } else {
                  // User is signed out.

                }

              });
        

            }
            function signOut(){
                    if (confirm("You are Going to Log Out")) {

                            firebase.auth().signOut().then(() => {
                              // Sign-out successful.
                                            console.log(user);
                                            document.getElementById('').textContent =email;
                // User is signed out.
                                }).catch((error) => {
                                    console.log(error);
                                                // An error happened.
                                });
              
                    } else {
                        txt = "You pressed Cancel!";
                }
          }
        function uploadFile() {
        let file = document.getElementById("filename").files[0];
        console.log("Filename: " + file.name + " size:" + file.size + " type:" + file.type);
        let metadata = {contentType: file.type};
        let uploadTask = firebase.storage().ref().child('documents/' + file.name).put(file, metadata);
        uploadTask.on(firebase.storage.TaskEvent.STATE_CHANGED, // or 'state_changed'
            function (snapshot) {
                let progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
                document.getElementById("files").innerHTML = 'Upload is ' + progress + '% done';
            },
            function (error) {
                console.log(error)
            },
            function () {
                uploadTask.snapshot.ref.getDownloadURL().then(function (downloadURL) {
                    console.log('File available at', downloadURL);
                });
            });
    }
  
    function listenForFiles() {
        firebase.firestore().collection("images")
            .orderBy("updated", "desc")
            .limit(3)
            .onSnapshot(function (querySnapshot) {
                let files = [];
                querySnapshot.forEach(function (doc) {
                    let file = doc.data();
                    // https://www.googleapis.com/download/storage/v1/b/unipi-aps.appspot.com/o/images%2FuNIPI.jpg?generation=1610549348125433&alt=media
                    // https://firebasestorage.googleapis.com/v0/b/unipi-aps.appspot.com/o/images%2FuNIPI.jpg?alt=media&token=c1a62660-cf1c-4e4f-a8fa-a0baf075d773
                    let url = file.mediaLink.replace(
                        'https://www.googleapis.com/download/storage/v1',
                        'https://firebasestorage.googleapis.com/v0');
                    let html = `<img src='${url}'/><br>${file.name}`
                    files.push(html);
                });
                document.getElementById("files").innerHTML = files.join("<br>");
            });
    }
</script>
        <!-- Bootstrap core JS-->

        <!-- Core theme JS-->

    </body>
</html>
