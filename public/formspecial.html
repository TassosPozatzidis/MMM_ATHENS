<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <meta name="description" content="" />
  <meta name="author" content="" />
  <title>Φόρμα ειδικής κατηγορίας</title>
  <!-- Favicon-->
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js"
    integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB" crossorigin="anonymous">
  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js"
    integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous">
  </script>
  <!--Import bootstrap js so i can make popovers-->
  <script src=”https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js”
    integrity=”sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ” crossorigin=”anonymous”>
  </script>

  <script defer src="/__/firebase/8.2.2/firebase-app.js"></script>
  <!-- include only the Firebase features as you need -->
  <script defer src="/__/firebase/8.2.2/firebase-auth.js"></script>
  <script defer src="/__/firebase/8.2.2/firebase-database.js"></script>
  <script defer src="/__/firebase/8.2.2/firebase-firestore.js"></script>
  <script defer src="/__/firebase/8.2.2/firebase-functions.js"></script>
  <script defer src="/__/firebase/8.2.2/firebase-messaging.js"></script>
  <script defer src="/__/firebase/8.2.2/firebase-storage.js"></script>
  <script defer src="/__/firebase/8.2.2/firebase-analytics.js"></script>
  <script defer src="/__/firebase/8.2.2/firebase-remote-config.js"></script>
  <script defer src="/__/firebase/8.2.2/firebase-performance.js"></script>
  <script defer src="/__/firebase/init.js?useEmulator=true"></script>
  <!-- Favicon-->
  <link rel="icon" type="image/x-icon" href="basicwebsite/public/assets/favicon.ico" />
  <!-- Bootstrap icons-->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet" />
  <!-- Core theme CSS (includes Bootstrap)-->
  <link href="styles.css" rel="stylesheet" />

  <!--Import poppers before js as need it-->
  <script src="/__/firebase/9.6.1/firebase-app-compat.js"></script>
  <script src="/__/firebase/9.6.1/firebase-auth-compat.js"></script>
  <script src="/__/firebase/init.js"></script>

</head>

<body>
  <!-- Responsive navbar-->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container px-lg-5">
      <a class="navbar-brand" href="generic.html">ΑΤΗ.ΕΝΑ ticket</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span
          class="navbar-toggler-icon"></span></button>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
          <li class="nav-item"><a class="nav-link" href="generic.html">Αρχική</a></li>
          <li class="nav-item"><a class="nav-link" href="about.html">Σχετικά</a></li>
          <li class="nav-item"><a class="nav-link" href="contact.html">Επικοινωνία</a></li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" role="button"
              data-bs-toggle="dropdown" aria-expanded="false">
              Ο Λογαριασμός μου
            </a>
            <ul class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
              <li><a class="dropdown-item" href="formspecial.html">Ειδική Κατηγορία</a></li>
              <li><a class="dropdown-item" onclick="signOut()">Αποσύνδεση</a></li>

            </ul>
          </li>
        </ul>
      </div>
    </div>
  </nav>



  <header class="py-5">
    <div class="container px-lg-5">
      <div class="p-6 p-lg-6 bg-light rounded-3 text-center">
        <h1 class="display-5 fw-bold">Ένταξη σε ειδική κατηγορία</h1>
        <p class="fs-4">Ανεβάζοντας τα κατάλληλα δικαιολογητικά και μετά από έλεγχο αυτών θα πραγματοποιηθεί η ένταξη
          σας στην
          ειδική κατηγορία μειωμένων εισιτηρίων του ΟΑΣΑ. Εγγραφόμενοι σε αυτή την κατηγορία θα μπορείτε να αγοράζεται
          εισιτήρια μειωμένης τιμής
          για την μετακίνησή σας με τα μεταφορικά μέσα του ΟΑΣΑ.
        </p>
        <!--<a class="btn btn-primary btn-lg" href="#!">Call to action</a>-->
        <p class="fs-5">Οι κατηγορίες που δικαιούνται εισιτήριο μειωμένου κομίστρου είναι:
          <p class="text-decoration-underline" data-bs-toggle="tooltip" data-bs-placement="bottom"
            title="Απαραίτητα δικαιολογητικά: φωτοτυπίες ταυτότητας και φοιτητικού πάσο ή βεβαίωση σπουδών.">1. Φοιτητές
            Τριτοβάθμιας Εκπαίδευσης</p>
          <p class="text-decoration-underline" data-bs-toggle="tooltip" data-bs-placement="bottom"
            title="Απαραίτητα δικαιολογητικά: φωτοτυπίες ταυτότητας και φοιτητικού πάσο ή βεβαίωση σπουδών.">2. Φοιτητές
            Σχολών Τριτοβάθμιας Εκπαίδευσης ή Πανεπιστημίων της Αλλοδαπής εώς την ηλικία των 25 ετών</p>
          <p class="text-decoration-underline" data-bs-toggle="tooltip" data-bs-placement="bottom"
            title="Απαραίτητα δικαιολογητικά: φωτοτυπίες ταυτότητας και δελτίο ειδικού κομίστρου.">3. Σπουδαστές
            Δημόσιων Ι.Ε.Κ.</p>
          <p class="text-decoration-underline" data-bs-toggle="tooltip" data-bs-placement="bottom"
            title="Απαραίτητα δικαιολογητικά: φωτοτυπίες ταυτότητας και δελτίο μαθητικού κομίστρου.">4. Μαθητές
            Πρωτοβάθμιας & Δευτεροβάθμιας Εκπαίδευσης άνω των 18 ετών</p>
          <p class="text-decoration-underline" data-bs-toggle="tooltip" data-bs-placement="bottom"
            title="Απαραίτητα δικαιολογητικά: φωτοτυπίες ταυτότητας και το πίσω μέρος του βιβλιαρίου πολυτέκνων θεωρημένο.">
            5. Πολύτεκνοι και Μέλη των οικογενειών τους</p>
          <p class="text-decoration-underline" data-bs-toggle="tooltip" data-bs-placement="bottom"
            title="Απαραίτητα δικαιολογητικά: φωτοτυπία ταυτότητας.">6. Νεόι από 13 έως 18 ετών</p>
          <p class="text-decoration-underline" data-bs-toggle="tooltip" data-bs-placement="bottom"
            title="Απαραίτητα δικαιολογητικά: φωτοτυπία ταυτότητας.">7. Άτομα ηλικίας άνω των 65 χρόνων</p>

        </p>
      </div>
    </div>
  </header>


  <header class="py-3">
    <div class="container px-lg-5 col-lg-6">
      <div class="bg-light text-center">
        <h1>Φόρμα Ένταξης Ειδικής Κατηγορίας</h1></br>
        <label for="category">Επιλογή Ειδικής Κατηγορίας:</label>
        <select class="form-control" name="category" id="category">
          <option value="1">Επιλογή 1</option>
          <option value="2">Επιλογή 2</option>
          <option value="3">Επιλογή 3</option>
          <option value="4">Επιλογή 4</option>
          <option value="5">Επιλογή 5</option>
          <option value="6">Επιλογή 6</option>
          <option value="7">Επιλογή 7</option>
        </select>
        <div class="form-group">
          <label for="name">Όνομα:</label>
          <input type="text" class="form-control" id="name" required>
        </div>
        <div class="form-group" required>
          <label for="surname">Επώνυμο:</label>
          <input type="text" class="form-control" id="surname">
        </div>
        <div>
          <label for="formFileLg" class="form-label">Φωτοτυπίες αστυνομικής ταυτότητας</label>
          <input class="form-control form-control-lg" id="filename1" type="file" required>
        </div>
        <div>
          <label for="formFileLg" class="form-label">Δικαιολογητικό ειδικής κατηγορίας</label>
          <input class="form-control form-control-lg" id="filename2" type="file" required>
        </div>
        <div><label for="formFileLg" class="form-label" id="files"></label></div>
        </br><a class="btn btn-primary btn-lg" id="Upload" onclick="uploadFile();addData();">Επιβεβαίωση</a>
        </br><a class="btn btn-primary btn-lg" id="Admin" onclick="addAdmin()">Make me Admin</a>
      </div>

    </div>
    </div>
  </header>





  <!--Here is the one time initialization of tooltip, the same goes for poppers. You need to initialize it one time -->
  <script>
    var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
    var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
      return new bootstrap.Tooltip(tooltipTriggerEl)
    })
  </script>

  <!--
                that is a button with a tooltip on it
            <button type="button" class="btn btn-secondary" data-bs-toggle="tooltip" data-bs-placement="top" title="Tooltip on top">
                 Tooltip on top
             </button>
                you add the below text in any class of button and you have tooltip
                data-bs-toggle="tooltip" data-bs-placement="top" title="Tooltip on top"

            -->


  </section>
  <!-- Footer-->
  <footer class="py-5 bg-dark">
    <div class="container">
      <p class="m-0 text-center text-white">Copyright &copy; GMIT@Unipi 2021</p>
    </div>
  </footer>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      listenForChanges();
      listenForFiles();
    });


    function addData() { //add a new Document to Collection Applications
      let user = firebase.auth().currentUser;
      let firstname = document.getElementById("name").value; //document attribute firstname
      let lastname = document.getElementById("surname").value;
      let filename1 = document.getElementById("filename1").value;
      let filename2 = document.getElementById("filename2").value;
      let category = document.getElementById("category").value;
      if (firstname.length < 1) {
        alert('Please enter a name.');
        return;
      }
      if (lastname.length < 1) {
        alert('Please enter a surname.');
        return;
      }
      if (document.getElementById("filename1").files.length == 0) {
        alert('Please insert a file (1).');
        return;
      }
      if (document.getElementById("filename2").files.length == 0) {
        alert('Please insert a file (2).');
        return;
      }
      if (category.length < 1) {
        alert('Please select a category.');
        return;
      }
      firebase.firestore().collection("Applications")
        .add({
          userID: user.uid,
          firstname: firstname,
          lastname: lastname,
          category: category,
          filename1: filename1,
          filename2: filename2,
          date: "1900-01-01"
        })
        .then(function (docRef) {
          console.log("Document written with ID: ", docRef.id);
        })
        .catch(function (error) {
          console.error("Error adding document: ", error);
        });
      setTimeout(function () {
        window.location.href = "SuccessApplication.html"
      }, 3000); //wait 3000 until the function complete-then redirect to SuccessApplication page
    }



    function uploadFile() {

      let user = firebase.auth().currentUser;
      let file1 = document.getElementById("filename1").files[0];
      let file2 = document.getElementById("filename2").files[0];
      const file = [file1, file2];
      /*   if (file1.length < 1) {
                   alert('Please insert a file.');
                   return;
                 }
                 if (file2.length < 1) {
                   alert('Please insert a file.');
                   return;
                 }*/
      //let file = document.getElementById(filename2).files[1];
      for (var i = 0, row; row = file[i]; i++) {
        console.log("Filename: " + file[i].name + " size:" + file[i].size + " type:" + file[i].type);
        let metadata = {
          contentType: file[i].type
        };
        let uploadTask = firebase.storage().ref().child('documents/' + user.uid + '/' + file[i].name).put(file[i],
          metadata);
        uploadTask.on(firebase.storage.TaskEvent.STATE_CHANGED, // or 'state_changed'
          function (snapshot) {
            let progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
            document.getElementById("files").innerHTML = 'Upload is ' + progress + '% done';
          },
          function (error) {
            console.log(error)
          },
          function () {
            uploadTask.snapshot.ref.getDownloadURL().then(function (downloadURL) {
              console.log('File available at', downloadURL);
            });
          });
      }
    }
  </script>
  <!-- Bootstrap core JS-->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
  <script type="text/javascript" src="js/common.js"></script>

</body>

</html>